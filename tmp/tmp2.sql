SELECT
  b.recipient_phone recipient_phone,
  max(a.user_id)                        user_id,
  max(is_food_continus)               is_food_continus,
  max(food_continus_days)             food_continus_days,
  max(food_continus_weight)           food_continus_weight,
  max(is_1hour2ord)                   is_1hour2ord,
  max(1hour2ord_days)                 1hour2ord_days,
  max(1hour2ord_weight)               1hour2ord_weight,
  max(is_7day14ord)                   is_7day14ord,
  max(7day14ord_days)                 7day14ord_days,
  max(7day14ord_weight)               7day14ord_weight,
  max(is_outofrange)                  is_outofrange,
  max(outofrange_days)                outofrange_days,
  max(outofrange_weight)              outofrange_weight,
  max(is_reopen)                      is_reopen,
  max(overlap_rate)                   overlap_rate,
  max(reopen_weight)                  reopen_weight,
  max(is_selford)                     is_selford,
  max(self_ord_num)                   self_ord_num,
  max(selford_weight)                 selford_weight,
  max(is_account_one2n)               is_account_one2n,
  max(one2n_phone_num)                one2n_phone_num,
  max(one2n_weight)                   one2n_weight,
  max(is_dense)                       is_dense,
  max(dense_ord_num)                  dense_ord_num,
  max(dense_weight)                   dense_weight,
  max(in_phone_blacklist_now)         in_phone_blacklist_now,
  max(in_phone_blacklist_ever)        in_phone_blacklist_ever,
  max(in_uuid_blacklist_now)          in_uuid_blacklist_now,
  max(in_uuid_blacklist_ever)         in_uuid_blacklist_ever,
  max(in_userid_blacklist_now)        in_userid_blacklist_now,
  max(in_userid_blacklist_ever)       in_userid_blacklist_ever,
  max(in_payaccount_blacklist_now)    in_payaccount_blacklist_now,
  max(in_payaccount_blacklist_ever)   in_payaccount_blacklist_ever,
  max(has_login_history)              has_login_history,
  max(cancel_bind_times)              cancel_bind_times,
  max(sourcelinkid)                   sourcelinkid,
  max(is_source_abnormal)             is_source_abnormal,
  max(campaign)                       campaign,
  max(medium)                         medium,
  max(source)                         source,
  max(content)                        content,
  max(term)                           term,
  max(regdate)                        regdate,
  max(cityid)                         cityid,
  max(platform)                       platform,
  max(clienttype)                     clienttype,
  max(platformid)                     platformid,
  max(appnm)                          appnm,
  max(secure_question_status)         secure_question_status,
  max(secure_question_modtimes)       secure_question_modtimes,
  max(safetylevel_score)              safetylevel_score,
  max(has_recharge_history)           has_recharge_history,
  max(recharge_times)                 recharge_times,
  max(has_refundapply_history)        has_refundapply_history,
  max(refundapply_times)              refundapply_times,
  max(device_first_purchase_times)    device_first_purchase_times,
  max(has_whole_client_fist_purchase) has_whole_client_fist_purchase,
  max(meituan_purchase_order_count)   meituan_purchase_order_count,
  max(meituan_lottery_order_count)    meituan_lottery_order_count,
  max(register_be_invited)            register_be_invited,
  max(has_invite_other_register)      has_invite_other_register,
  max(invite_other_register_count)    invite_other_register_count,
  max(has_qr_history)                 has_qr_history,
  max(growth_value)                   growth_value,
  max(growth_level)                   growth_level,
  max(has_interest)                   has_interest,
  max(in_yaxin_blacklist)             in_yaxin_blacklist,
  max(yaxin_blacklist_record_count)   yaxin_blacklist_record_count,
  max(has_search_record)              has_search_record,
  max(search_times)                   search_times,
  max(has_blacklistuuid_record)       has_blacklistuuid_record,
  max(blacklistuuid_uuid_count)       blacklistuuid_uuid_count,
  max(blacklistuuid_record_count)     blacklistuuid_record_count,
  max(has_biz_daohao_record)          has_biz_daohao_record,
  max(has_usersafe_daohao_record)     has_usersafe_daohao_record,
  max(islotteryuser)                  islotteryuser,
  max(ps_range_percent)               ps_range_percent,
  max(uuid32_percent)                 uuid32_percent,
  max(2order_percent)                 2order_percent,
  max(other_dtype__percent)           other_dtype__percent,
  max(order_num)                      order_num,
  max(aver_order)                     aver_order,
  max(aver_charge)                    aver_charge,
  max(start_time_before_120s)         start_time_before_120s,
  max(start_time_before_240s)         start_time_before_240s,
  max(start_time_after_60s)           start_time_after_60s,
  max(start_time_after_180s)          start_time_after_180s,
  max(start_order_ratio)              start_order_ratio,
  max(all_time_before_120s)           all_time_before_120s,
  max(all_time_after_180s)            all_time_after_180s,
  max(all_order_ratio)                all_order_ratio,
  max(city_refresh)                   city_refresh,
  max(order_dist_entropy)             order_dist_entropy,
  max(poi_refresh)                    poi_refresh,
  max(max_continue_order_num)         max_continue_order_num,
  max(max_continue_2_order_num)       max_continue_2_order_num
FROM
  mart_waimai_risk.aggr_dapan_analysis__usr_risk a
  INNER JOIN
  (
    SELECT
      user_id,
      recipient_phone
    FROM
      mart_waimai_risk.fact_act_base_risk
    WHERE
      dt >= '20150601'
    GROUP BY
      user_id, recipient_phone
  ) b
    ON
      a.user_id = b.user_id
GROUP BY
  b.recipient_phone